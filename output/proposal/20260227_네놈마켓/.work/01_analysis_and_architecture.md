# 네놈마켓 B2B 플랫폼 — 요구분석 및 기술 아키텍처 설계서

> **문서 버전**: v1.0
> **작성일**: 2026-02-27
> **프로젝트명**: 네놈마켓 (B2B 도매/유통 플랫폼)
> **프로젝트 유형**: 반응형 웹 애플리케이션

---

# Part 1: 현황 분석 및 요구사항 정의

---

## 1. 프로젝트 배경 및 목적

### 1.1 프로젝트 추진 배경

국내 B2B 농수축산물 유통 시장은 여전히 카카오톡, 전화, 엑셀 기반의 수작업 프로세스에 크게 의존하고 있다. 공급사와 셀러 간 주문-발주-송장 연결이 파편화되어 있으며, 가격 변동이 빈번한 신선식품 특성상 실시간 가격 반영과 재고 관리가 어렵다. 셀러는 쿠팡, 스마트스토어 등 다양한 채널의 주문을 수기로 취합해야 하고, 관리자는 공급사별로 상이한 엑셀 양식에 맞춰 발주서를 생성하는 반복 업무에 상당한 시간을 소모한다.

### 1.2 해결하려는 문제

| 구분 | 현재 문제 | 해결 방향 |
|------|-----------|-----------|
| 주문 처리 | 카톡/엑셀 수작업, 채널별 양식 불일치 | AI 기반 엑셀 자동 인식 및 통합 주문 관리 |
| 발주 관리 | 공급사별 상이한 양식, 수작업 취합 | 공급사별 맞춤 발주서 자동 생성 |
| 송장 관리 | 공급사 회신 송장을 주문에 수동 매칭 | 송장 엑셀 업로드 시 자동 매칭 |
| 가격 관리 | 가격 변동 시 개별 통보, 반영 지연 | 실시간 가격 변경 + 자동 알림 |
| 정산 관리 | 수작업 정산, 클레임 반영 누락 | 자동 정산 및 클레임 연동 |
| 업무 효율 | 모든 작업에 대시보드 직접 조작 필요 | AI 채팅으로 자연어 업무 처리 |

### 1.3 프로젝트 목표

1. **업무 자동화**: 주문 취합, 발주서 생성, 송장 매칭, 정산 계산 등 반복 업무를 자동화하여 관리자 업무 부하를 70% 이상 절감한다.
2. **AI 채팅 인터페이스**: 자연어 기반 업무 처리를 통해 비개발자도 직관적으로 시스템을 활용할 수 있도록 한다.
3. **통합 관리 플랫폼**: 상품-주문-배송-정산-CS를 하나의 플랫폼에서 일원화하여 데이터 정합성을 확보한다.
4. **확장 가능한 아키텍처**: 초기 Vercel/Supabase 기반으로 빠르게 론칭하되, 트래픽 증가 시 AWS 전환이 용이한 구조를 설계한다.

### 1.4 기대 효과

- 주문 처리 시간 단축: 기존 대비 60~80% 감소
- 발주/송장 오류율 감소: 수작업 대비 95% 이상 정확도 향상
- 셀러 온보딩 시간 단축: AI 채팅을 통한 직관적 UX 제공
- 실시간 경영 데이터 제공: 대시보드 기반 의사결정 지원

---

## 2. 현황 분석

### 2.1 유사 서비스 분석

국내 B2B 식자재/농수축산물 유통 플랫폼 중 대표 서비스 3개를 비교 분석한다.

| 비교 항목 | 식봄 (Sikbom) | 마켓보로 (MarketBoro) | 푸드팡 (FoodPang) |
|-----------|--------------|----------------------|-------------------|
| **서비스 유형** | B2B 식자재 유통 플랫폼 | B2B 식자재 수발주 SaaS | B2B 농수산물 도매 플랫폼 |
| **주요 타깃** | 식당/카페 사업자 | 식자재 유통사/납품업체 | 소매상/중간유통업체 |
| **핵심 기능** | 온라인 주문, 배송 추적, 정산 관리 | 수발주 자동화, 거래명세서, ERP 연동 | 경매 연동, 산지직송, 가격 비교 |
| **AI 활용** | 수요 예측 (제한적) | 없음 | 없음 |
| **모바일 대응** | 앱 기반 (iOS/Android) | 웹 + 모바일 웹 | 웹 기반 |
| **엑셀 연동** | 제한적 | 엑셀 수발주 지원 | 제한적 |
| **가격 모델** | 거래 수수료 | SaaS 월정액 | 거래 수수료 |
| **차별점** | 다품종 식자재 커버리지 | 기존 거래 관계 디지털 전환 | 산지 직거래 네트워크 |

### 2.2 네놈마켓 차별화 전략

| 차별화 포인트 | 설명 |
|--------------|------|
| **AI 채팅 우선 인터페이스** | 대시보드는 보조 수단, AI 채팅이 메인 업무 처리 채널 (업계 최초) |
| **멀티 채널 주문 자동 통합** | 쿠팡/스마트스토어/자체몰 등 어떤 엑셀이든 AI가 컬럼 자동 인식 |
| **공급사 맞춤 발주 자동화** | 공급사별 상이한 엑셀 양식에 맞춘 발주서 자동 생성 |
| **등급/개별 가격 체계** | 셀러 등급별 차등 가격 + 개별 셀러 특가 설정 |
| **실시간 클레임-정산 연동** | 반품/환불 발생 시 정산에 자동 반영 |

### 2.3 시장 현황 및 트렌드

**시장 규모**: 국내 B2B 식자재 유통 시장은 약 150조원 규모이며, 온라인 전환율은 약 5~8%로 아직 초기 단계이다.

**주요 트렌드**:
1. **디지털 전환 가속화**: 코로나19 이후 B2B 식자재 온라인 거래가 연 20% 이상 성장 중
2. **AI 도입 확대**: 수요 예측, 가격 최적화, 고객 응대에 AI 활용 증가
3. **산지 직거래 확대**: 중간 유통 단계 축소를 통한 마진 확보 경쟁
4. **SaaS 전환**: 자체 시스템 구축 대신 SaaS 기반 솔루션 채택 증가
5. **실시간 데이터 기반 의사결정**: 대시보드 및 분석 도구에 대한 수요 증가

---

## 3. 기능 요구사항 (Functional Requirements)

### 3.1 플랫폼 관리자 기능

#### 3.1.1 상품 관리

| 기능 ID | 기능명 | 설명 | 우선순위 | 상태 | 관련 화면 |
|---------|--------|------|----------|------|-----------|
| FR-PM-001 | 상품 수동 등록 | 개별 상품 정보(상품명, 가격, 카테고리, 이미지 등)를 입력하여 등록 | 필수 | 구현완료 | 상품관리 > 상품등록 |
| FR-PM-002 | 상품 엑셀 대량 등록 | 엑셀 파일 업로드를 통한 다수 상품 일괄 등록 | 필수 | 구현완료 | 상품관리 > 엑셀업로드 |
| FR-PM-003 | 상품 가격 빠른 수정 | 개별 또는 일괄로 상품 가격을 수정 (비율/금액 기반) | 필수 | 구현완료 | 상품관리 > 가격수정 |
| FR-PM-004 | 등급별 차등 가격 설정 | 셀러 등급에 따라 상품별 차등 가격 적용 | 필수 | 구현완료 | 상품관리 > 가격설정 |
| FR-PM-005 | 셀러별 개별 가격 설정 | 특정 셀러에 대한 상품 개별 가격 설정 (등급 무관) | 추천 | 구현완료 | 상품관리 > 특가설정 |
| FR-PM-006 | 상품 상태 관리 | 판매중/품절/단종 상태 전환 관리 | 필수 | 구현완료 | 상품관리 > 상품목록 |
| FR-PM-007 | 재고 수량 관리 | 상품별 재고 수량 등록, 수정, 조회 | 필수 | 구현완료 | 상품관리 > 재고관리 |
| FR-PM-008 | 재고 부족 자동 알림 | 설정한 안전 재고 이하 시 관리자에게 알림 발송 | 추천 | 개발 필요 | 알림센터 |

#### 3.1.2 주문 관리

| 기능 ID | 기능명 | 설명 | 우선순위 | 상태 | 관련 화면 |
|---------|--------|------|----------|------|-----------|
| FR-OM-001 | 셀러 주문 접수 확인 | 셀러가 등록한 주문 목록 조회 및 접수 확인 | 필수 | 구현완료 | 주문관리 > 주문목록 |
| FR-OM-002 | 주문 취합 | 공급사별/상품별로 주문을 그룹핑하여 취합 | 필수 | 구현완료 | 주문관리 > 주문취합 |
| FR-OM-003 | 공급사 발주서 엑셀 다운로드 | 공급사 양식에 맞춘 발주서 엑셀 파일 생성 및 다운로드 | 필수 | 구현완료 | 주문관리 > 발주관리 |
| FR-OM-004 | 공급사 송장 엑셀 업로드 | 공급사가 회신한 송장 엑셀 업로드 시 주문별 자동 매칭 | 필수 | 개발 필요 | 주문관리 > 송장관리 |
| FR-OM-005 | 자체 상품 송장 직접 입력 | 자체 배송 상품에 대한 송장번호 직접 입력 | 필수 | 구현완료 | 주문관리 > 송장입력 |
| FR-OM-006 | 주문 상태 변경 | 준비중/배송중/배송완료 등 주문 상태 전환 | 필수 | 구현완료 | 주문관리 > 주문상세 |

#### 3.1.3 배송 관리

| 기능 ID | 기능명 | 설명 | 우선순위 | 상태 | 관련 화면 |
|---------|--------|------|----------|------|-----------|
| FR-DM-001 | 공급사 송장 엑셀 업로드 | 공급사별 송장 정보 엑셀 업로드 및 주문 매칭 | 필수 | 개발 필요 | 배송관리 > 송장업로드 |
| FR-DM-002 | 택배사 API 연동 (집하 요청) | CJ대한통운 등 택배사 API 통한 집하 요청 및 송장번호 자동 수신 | 추천 | 개발 필요 | 배송관리 > 택배연동 |
| FR-DM-003 | 송장 엑셀 일괄 등록 | 다수 주문의 송장번호를 엑셀로 일괄 등록 | 필수 | 구현완료 | 배송관리 > 송장등록 |
| FR-DM-004 | 송장 개별 직접 입력 | 개별 주문에 송장번호 직접 입력 | 필수 | 구현완료 | 배송관리 > 주문상세 |
| FR-DM-005 | 배송 추적 | 택배사 API 연동 기반 실시간 배송 상태 조회 | 추천 | 개발 필요 | 배송관리 > 배송추적 |

#### 3.1.4 회원 관리

| 기능 ID | 기능명 | 설명 | 우선순위 | 상태 | 관련 화면 |
|---------|--------|------|----------|------|-----------|
| FR-MM-001 | 셀러 가입 승인/반려 | 사업자등록증 확인 후 셀러 가입 승인 또는 반려 처리 | 필수 | 구현완료 | 회원관리 > 가입승인 |
| FR-MM-002 | 셀러 등급 관리 | 셀러 등급 생성, 수정, 삭제 (골드/실버/브론즈 등) | 필수 | 구현완료 | 회원관리 > 등급관리 |
| FR-MM-003 | 등급별 수수료율 설정 | 셀러 등급별 거래 수수료율 설정 | 필수 | 구현완료 | 회원관리 > 수수료설정 |
| FR-MM-004 | 개별 셀러 수수료율 설정 | 등급과 무관하게 특정 셀러에 대한 개별 수수료율 설정 | 추천 | 구현완료 | 회원관리 > 셀러상세 |
| FR-MM-005 | 셀러 정보 관리 | 셀러 프로필, 사업자 정보, 연락처 등 관리 | 필수 | 구현완료 | 회원관리 > 셀러목록 |

#### 3.1.5 정산/매출 관리

| 기능 ID | 기능명 | 설명 | 우선순위 | 상태 | 관련 화면 |
|---------|--------|------|----------|------|-----------|
| FR-SM-001 | 셀러별 매출 집계 | 기간별 셀러 매출 자동 집계 | 필수 | 개발 필요 | 정산관리 > 매출집계 |
| FR-SM-002 | 수수료 자동 계산 | 등급 수수료 또는 개별 수수료 기반 자동 계산 | 필수 | 개발 필요 | 정산관리 > 수수료계산 |
| FR-SM-003 | 반품/환불 정산 반영 | 클레임 처리 결과를 정산에 자동 반영 | 필수 | 개발 필요 | 정산관리 > 정산내역 |
| FR-SM-004 | 마진율 관리 | 상품별/카테고리별 마진율 조회 및 관리 | 추천 | 개발 필요 | 정산관리 > 마진분석 |
| FR-SM-005 | 통계 대시보드 | 일/주/월별 매출, 상품별 판매량, 셀러별 통계 등 종합 대시보드 | 필수 | 개발 필요 | 대시보드 (페이지 존재, API 미구현) |
| FR-SM-006 | 정산 내역 엑셀 다운로드 | 정산 결과를 엑셀 파일로 다운로드 | 필수 | 개발 필요 | 정산관리 > 다운로드 |

#### 3.1.6 CS 관리

| 기능 ID | 기능명 | 설명 | 우선순위 | 상태 | 관련 화면 |
|---------|--------|------|----------|------|-----------|
| FR-CS-001 | 게시판 문의 확인/답변 | 셀러 문의 조회 및 답변 처리 | 필수 | 개발 필요 | CS관리 > 문의관리 (페이지 존재, API 미구현) |
| FR-CS-002 | 클레임 관리 | 반품/환불/교환 요청 접수, 승인, 처리, 정산 반영 | 필수 | 개발 필요 | CS관리 > 클레임관리 (페이지 존재, API 미구현) |
| FR-CS-003 | 교환 재배송 처리 | 교환 승인 시 재배송 처리 및 신규 송장 입력 | 추천 | 개발 필요 | CS관리 > 클레임상세 |

#### 3.1.7 공급사 관리

| 기능 ID | 기능명 | 설명 | 우선순위 | 상태 | 관련 화면 |
|---------|--------|------|----------|------|-----------|
| FR-SP-001 | 공급사 정보 등록 | 업체명, 연락처, 담당자 등 공급사 기본 정보 등록 | 필수 | 구현완료 | 공급사관리 > 등록 |
| FR-SP-002 | 발주 엑셀 양식 템플릿 관리 | 공급사별 발주서 엑셀 양식 템플릿 등록/수정 | 추천 | 개발 필요 | 공급사관리 > 양식관리 |
| FR-SP-003 | 발주/입고 이력 관리 | 공급사별 발주 및 입고 이력 조회 | 필수 | 구현완료 | 공급사관리 > 이력조회 |

#### 3.1.8 알림/공지

| 기능 ID | 기능명 | 설명 | 우선순위 | 상태 | 관련 화면 |
|---------|--------|------|----------|------|-----------|
| FR-NT-001 | 셀러 공지사항 발송 | 전체 또는 특정 셀러 대상 공지사항 작성 및 발송 | 필수 | 개발 필요 | 공지관리 (페이지 존재, API 미구현) |
| FR-NT-002 | 가격 변동/품절 안내 | 상품 가격 변동 또는 품절 발생 시 자동 알림 | 추천 | 개발 필요 | 알림센터 |
| FR-NT-003 | 카카오 알림톡 연동 | 카카오 알림톡 API를 통한 외부 알림 발송 | 추천 | 개발 필요 | 알림설정 |

#### 3.1.9 관리자 권한

| 기능 ID | 기능명 | 설명 | 우선순위 | 상태 | 관련 화면 |
|---------|--------|------|----------|------|-----------|
| FR-AU-001 | 관리자 권한 분리 | 슈퍼 관리자/일반 관리자 역할별 권한 차등 적용 | 추천 | 개발 필요 | 시스템설정 > 권한관리 (역할 구분만 존재) |
| FR-AU-002 | 활동 로그 | 관리자 활동 이력 기록 및 조회 | 선택 | 개발 필요 | 시스템설정 > 활동로그 (모델 존재, 로직 미구현) |

### 3.2 셀러 기능

#### 3.2.1 상품 조회

| 기능 ID | 기능명 | 설명 | 우선순위 | 상태 | 관련 화면 |
|---------|--------|------|----------|------|-----------|
| FR-SL-001 | 상품 리스트 조회 | 셀러 등급별 가격이 반영된 판매 가능 상품 목록 조회 | 필수 | 구현완료 | 셀러 > 상품목록 |
| FR-SL-002 | 상품 리스트 엑셀 다운로드 | 조회한 상품 목록을 엑셀 파일로 다운로드 | 추천 | 구현완료 | 셀러 > 상품목록 |

#### 3.2.2 주문 관리

| 기능 ID | 기능명 | 설명 | 우선순위 | 상태 | 관련 화면 |
|---------|--------|------|----------|------|-----------|
| FR-SO-001 | 주문 엑셀 업로드 (AI 자동 인식) | 어떤 양식이든 엑셀 업로드 시 AI가 컬럼 자동 매핑하여 주문 등록 | 필수 | 개발 필요 | 셀러 > 주문업로드 |
| FR-SO-002 | 주문 수동 입력 | 개별 주문건 수동 입력 등록 | 필수 | 구현완료 | 셀러 > 주문입력 |
| FR-SO-003 | 주문 현황 조회 | 본인의 주문 목록 및 상태 조회 | 필수 | 구현완료 | 셀러 > 주문현황 |
| FR-SO-004 | 송장번호 확인 | 주문에 송장번호가 입력되면 실시간 확인 | 필수 | 구현완료 | 셀러 > 주문현황 |
| FR-SO-005 | 주문 상태 확인 | 주문 진행 상태 실시간 조회 | 필수 | 구현완료 | 셀러 > 주문상세 |

#### 3.2.3 클레임

| 기능 ID | 기능명 | 설명 | 우선순위 | 상태 | 관련 화면 |
|---------|--------|------|----------|------|-----------|
| FR-SC-001 | 반품/환불/교환 요청 등록 | 클레임 유형 선택 및 사유 작성하여 요청 등록 | 필수 | 개발 필요 | 셀러 > 클레임신청 (페이지 존재, API 미구현) |
| FR-SC-002 | 클레임 진행 상태 확인 | 등록한 클레임의 처리 진행 상태 조회 | 필수 | 개발 필요 | 셀러 > 클레임현황 (페이지 존재, API 미구현) |

#### 3.2.4 회원가입

| 기능 ID | 기능명 | 설명 | 우선순위 | 상태 | 관련 화면 |
|---------|--------|------|----------|------|-----------|
| FR-SR-001 | 회원가입 (사업자등록증 첨부) | 사업자등록증 필수 첨부 회원가입 | 필수 | 구현완료 | 회원가입 |
| FR-SR-002 | 관리자 승인 후 이용 | 가입 후 관리자 승인까지 대기 상태, 승인 후 서비스 이용 가능 | 필수 | 구현완료 | 로그인/대기화면 |

#### 3.2.5 통계/정산

| 기능 ID | 기능명 | 설명 | 우선순위 | 상태 | 관련 화면 |
|---------|--------|------|----------|------|-----------|
| FR-SS-001 | 내 매출 통계 | 본인의 기간별 매출 통계 조회 | 필수 | 개발 필요 | 셀러 > 통계 (페이지 존재, API 미구현) |
| FR-SS-002 | 상품별 판매량/금액 | 본인이 주문한 상품별 판매 실적 조회 | 추천 | 개발 필요 | 셀러 > 통계 |
| FR-SS-003 | 주문 상태별 현황 | 본인 주문의 상태별 현황 통계 | 추천 | 개발 필요 | 셀러 > 통계 |
| FR-SS-004 | 월별 주문수/매출 추이 | 월별 주문 건수 및 매출 추이 차트 | 추천 | 개발 필요 | 셀러 > 통계 |
| FR-SS-005 | 내 정산 내역 조회 | 본인의 정산 내역 및 수수료 내역 조회 | 필수 | 개발 필요 | 셀러 > 정산 (페이지 존재, API 미구현) |

#### 3.2.6 기타

| 기능 ID | 기능명 | 설명 | 우선순위 | 상태 | 관련 화면 |
|---------|--------|------|----------|------|-----------|
| FR-SE-001 | 게시판 문의 작성 | CS 게시판에 문의 글 작성 | 필수 | 개발 필요 | 셀러 > 게시판 (페이지 존재, API 미구현) |
| FR-SE-002 | 알림 수신 | 송장 입력, 가격 변동 등 알림 수신 | 추천 | 개발 필요 | 셀러 > 알림센터 |
| FR-SE-003 | AI 채팅 업무 처리 | AI 채팅으로 권한 범위 내 업무 수행 | 필수 | 개발 필요 | 공통 > AI 채팅 |

### 3.3 AI 채팅 인터페이스

| 기능 ID | 기능명 | 설명 | 우선순위 | 상태 | 관련 화면 |
|---------|--------|------|----------|------|-----------|
| FR-AI-001 | AI 채팅 UI | 대시보드 우측에 상시 표시되는 채팅 인터페이스 | 필수 | 개발 필요 | 공통 > 채팅패널 |
| FR-AI-002 | 자연어 명령 처리 | 자연어 입력을 기능 실행으로 변환 (Claude API 연동) | 필수 | 개발 필요 | 공통 > 채팅패널 |
| FR-AI-003 | 파일 업로드/다운로드 | 채팅 내 엑셀 파일 첨부 업로드 및 결과 파일 다운로드 | 필수 | 개발 필요 | 공통 > 채팅패널 |
| FR-AI-004 | 역할별 권한 분리 | 관리자/셀러 역할에 따른 AI 명령 실행 범위 제한 | 필수 | 개발 필요 | 공통 > 채팅패널 |
| FR-AI-005 | 자동 알림 (AI→관리자) | 송장 입력, 신규 주문, 재고 부족, 이상 탐지 시 자동 알림 | 추천 | 개발 필요 | 공통 > 채팅패널 |
| FR-AI-006 | AI 엑셀 자동 매핑 | 업로드된 엑셀의 컬럼을 AI가 자동 인식하여 데이터 매핑 | 필수 | 개발 필요 | 공통 > 채팅패널 |
| FR-AI-007 | 셀러 문의 AI 1차 응답 | 배송 추적, 재고 확인 등 단순 문의에 AI가 자동 응답 | 추천 | 개발 필요 | 공통 > 채팅패널 |
| FR-AI-008 | 이상 탐지 | 주문 급증, 높은 반품률, 발주 미수신 등 이상 상황 자동 감지 | 선택 | 개발 필요 | 공통 > 채팅패널 |

### 3.4 기능 요구사항 요약

| 구분 | 전체 | 구현완료 | 개발 필요 |
|------|------|---------|-----------|
| 관리자 - 상품 관리 | 8 | 7 | 1 |
| 관리자 - 주문 관리 | 6 | 5 | 1 |
| 관리자 - 배송 관리 | 5 | 2 | 3 |
| 관리자 - 회원 관리 | 5 | 5 | 0 |
| 관리자 - 정산/매출 관리 | 6 | 0 | 6 |
| 관리자 - CS 관리 | 3 | 0 | 3 |
| 관리자 - 공급사 관리 | 3 | 2 | 1 |
| 관리자 - 알림/공지 | 3 | 0 | 3 |
| 관리자 - 권한 관리 | 2 | 0 | 2 |
| 셀러 - 상품 조회 | 2 | 2 | 0 |
| 셀러 - 주문 관리 | 5 | 4 | 1 |
| 셀러 - 클레임 | 2 | 0 | 2 |
| 셀러 - 회원가입 | 2 | 2 | 0 |
| 셀러 - 통계/정산 | 5 | 0 | 5 |
| 셀러 - 기타 | 3 | 0 | 3 |
| AI 채팅 | 8 | 0 | 8 |
| **합계** | **68** | **29** | **39** |

**구현 진행률**: 약 42.6% (29/68)

---

## 4. 비기능 요구사항 (Non-Functional Requirements)

### 4.1 성능 (Performance)

| 항목 | 요구 수준 | 비고 |
|------|-----------|------|
| 페이지 로딩 시간 | 3초 이내 (초기 로드), 1초 이내 (페이지 전환) | Next.js SSR + 코드 스플리팅 활용 |
| API 응답 시간 | 평균 200ms 이내, 최대 2초 이내 | 엑셀 처리 등 대용량 작업 제외 |
| AI 채팅 응답 시간 | 5초 이내 (스트리밍 시작), 30초 이내 (전체 응답) | Claude API 스트리밍 응답 활용 |
| 동시 접속자 | 100명 동시 접속 지원 (초기), 500명까지 확장 가능 | B2B 특성상 동시 사용자 제한적 |
| 엑셀 처리 | 10,000행 이내 엑셀 파일 30초 내 처리 | 서버 사이드 처리 |
| WebSocket 지연 | 메시지 전송 후 500ms 이내 수신 | 채팅 실시간성 보장 |

### 4.2 보안 (Security)

| 항목 | 요구 수준 | 구현 방안 |
|------|-----------|-----------|
| 인증 | 세션 기반 인증 (NextAuth.js) | Credential Provider + JWT 세션 |
| 인가 | 역할 기반 접근 제어 (RBAC) | 관리자/셀러 역할별 API 미들웨어 |
| 데이터 암호화 | 전송 중 암호화 (TLS 1.3) | Vercel 기본 HTTPS |
| 데이터 암호화 | 저장 시 민감정보 암호화 | 사업자등록번호, 비밀번호 해시 (bcrypt) |
| OWASP 대응 | OWASP Top 10 대응 | SQL Injection (Prisma ORM), XSS (React 기본 이스케이프), CSRF (NextAuth.js 내장) |
| 파일 업로드 보안 | 파일 타입/크기 검증 | 허용 확장자 제한 (.xlsx, .xls, .csv, .jpg, .png, .pdf) |
| API 보안 | Rate Limiting | API 엔드포인트별 요청 제한 |
| 개인정보 보호 | 개인정보처리방침 준수 | 사업자 정보, 주문 정보 관리 기준 수립 |

### 4.3 가용성 (Availability)

| 항목 | 요구 수준 | 비고 |
|------|-----------|------|
| SLA 목표 | 99.5% (월간) | 월 약 3.6시간 이하 다운타임 허용 |
| 장애 복구 시간 (RTO) | 4시간 이내 | Vercel 자동 복구 + DB 백업 복원 |
| 데이터 복구 시점 (RPO) | 1시간 이내 | Supabase 자동 백업 (일 1회) + Point-in-Time Recovery |
| 배포 전략 | 무중단 배포 | Vercel Immutable Deployments |
| 모니터링 | 서버 상태, API 응답시간, 에러율 | Vercel Analytics + Sentry |
| 장애 알림 | 장애 발생 시 즉시 알림 | Sentry Alert + Slack/이메일 연동 |

### 4.4 확장성 (Scalability)

| 항목 | 초기 (Vercel/Supabase) | 확장 시 (AWS) |
|------|----------------------|---------------|
| **웹 서버** | Vercel Serverless Functions (자동 스케일링) | AWS ECS (컨테이너 기반 수평 확장) |
| **WebSocket** | Railway/Render (단일 인스턴스) | AWS EC2 + ALB (다중 인스턴스) |
| **DB** | Supabase PostgreSQL (단일 인스턴스) | AWS RDS Multi-AZ (읽기 복제본) |
| **파일 스토리지** | Supabase Storage | AWS S3 + CloudFront (CDN) |
| **캐시** | 없음 (초기) | Redis (ElastiCache) |
| **전환 전략** | Docker 컨테이너 기반 개발로 전환 용이성 확보 | 트래픽 임계치 도달 시 단계적 전환 |

**확장 트리거 기준**:
- 동시 접속자 200명 초과 지속
- DB 커넥션 풀 80% 이상 사용
- API 응답 시간 평균 1초 초과
- 월 스토리지 사용량 100GB 초과

---

# Part 2: 기술 아키텍처 설계

---

## 1. 시스템 아키텍처 다이어그램

```
+------------------------------------------------------------------+
|                        Client Layer                               |
|                                                                   |
|  +---------------------------+  +-----------------------------+   |
|  |    Web Browser (PC)       |  |   Web Browser (Mobile)      |   |
|  |    - 관리자 대시보드       |  |   - 반응형 셀러 화면         |   |
|  |    - 셀러 대시보드         |  |   - AI 채팅                  |   |
|  |    - AI 채팅 패널          |  |                             |   |
|  +------------+--------------+  +-----------+-----------------+   |
|               |                             |                     |
+---------------|-----------------------------|----- ---------------+
                |          HTTPS              |
                v                             v
+------------------------------------------------------------------+
|                     Application Layer                             |
|                                                                   |
|  +------------------------------------------------------------+  |
|  |              Next.js 15 (App Router) on Vercel              |  |
|  |                                                              |  |
|  |  +------------------+  +------------------+  +------------+ |  |
|  |  | SSR Pages        |  | API Routes       |  | Middleware  | |  |
|  |  | (React 19 + RSC) |  | (/api/*)         |  | (Auth/RBAC)| |  |
|  |  +------------------+  +------------------+  +------------+ |  |
|  |                                                              |  |
|  |  +------------------+  +------------------+  +------------+ |  |
|  |  | Server Actions   |  | Cron Jobs        |  | File       | |  |
|  |  | (Form handling)  |  | (정산 배치)       |  | Processing | |  |
|  |  +------------------+  +------------------+  +------------+ |  |
|  +------------------------------------------------------------+  |
|                                                                   |
|  +------------------------------------------------------------+  |
|  |          WebSocket Server (Railway / Render)                |  |
|  |          - AI 채팅 실시간 통신                                |  |
|  |          - 알림 푸시                                          |  |
|  +------------------------------------------------------------+  |
|                                                                   |
+------------------------------------------------------------------+
                |              |              |
                v              v              v
+------------------------------------------------------------------+
|                       Data Layer                                  |
|                                                                   |
|  +------------------+  +------------------+  +----------------+  |
|  | Supabase         |  | Supabase         |  | Prisma ORM    |  |
|  | PostgreSQL       |  | Storage          |  | (Data Access) |  |
|  | - 사용자 데이터   |  | - 엑셀 파일      |  |               |  |
|  | - 주문/상품      |  | - 사업자등록증    |  |               |  |
|  | - 정산/클레임    |  | - 발주서          |  |               |  |
|  +------------------+  +------------------+  +----------------+  |
|                                                                   |
+------------------------------------------------------------------+
                |              |              |
                v              v              v
+------------------------------------------------------------------+
|                    External Services                              |
|                                                                   |
|  +------------------+  +------------------+  +----------------+  |
|  | Claude API       |  | CJ대한통운 API   |  | 카카오         |  |
|  | (Anthropic)      |  | - 집하 요청      |  | 알림톡 API    |  |
|  | - 자연어 처리     |  | - 송장 조회      |  | - 알림 발송   |  |
|  | - 엑셀 컬럼 매핑  |  | - 배송 추적      |  |               |  |
|  | - 이상 탐지       |  |                  |  |               |  |
|  +------------------+  +------------------+  +----------------+  |
|                                                                   |
+------------------------------------------------------------------+
```

### 데이터 흐름 요약

```
[셀러 주문 등록]
  Browser → Next.js API Route → Prisma → PostgreSQL
                                      → Supabase Storage (엑셀 파일)

[AI 채팅 요청]
  Browser → WebSocket Server → Claude API (자연어 해석)
                             → Next.js API (기능 실행)
                             → Browser (스트리밍 응답)

[발주서 생성]
  관리자 요청 → API Route → DB 조회 (주문 취합)
                          → xlsx 라이브러리 (엑셀 생성)
                          → Supabase Storage (파일 저장)
                          → Browser (다운로드)

[택배 연동]
  관리자 집하 요청 → API Route → CJ대한통운 API (집하 요청)
                              → 송장번호 수신 → DB 업데이트
                              → WebSocket (셀러 알림)
```

---

## 2. 기술 스택 상세

### 2.1 프론트엔드

| 기술 | 버전 | 선정 사유 |
|------|------|-----------|
| **Next.js 15** | 15.x | App Router 기반 SSR/SSG 지원, API Routes 내장으로 별도 백엔드 불필요. React Server Components로 초기 로딩 최적화. Vercel 최적 배포 지원 |
| **React 19** | 19.x | Next.js 15 기본 포함. Server Components, Suspense, Streaming SSR 등 최신 기능 활용 |
| **TypeScript** | 5.x | 타입 안전성 확보로 런타임 에러 방지. B2B 도메인의 복잡한 데이터 구조를 타입으로 명확히 정의 |
| **Tailwind CSS** | 3.x | 유틸리티 기반 빠른 UI 개발. 반응형 디자인 용이. 커스텀 디자인 시스템 구축 지원 |
| **shadcn/ui** | latest | Radix UI 기반 접근성 준수 컴포넌트. 복사-수정 방식으로 완전한 커스터마이징 가능. 테이블, 폼, 대시보드 등 B2B에 필요한 컴포넌트 풍부 |

### 2.2 백엔드

| 기술 | 버전 | 선정 사유 |
|------|------|-----------|
| **Next.js API Routes** | 15.x | 프론트엔드와 동일 프로젝트에서 API 개발. Serverless 기반 자동 스케일링. 별도 서버 운영 불필요 |
| **Prisma ORM** | 5.x | 타입 안전한 데이터베이스 접근. 자동 마이그레이션 관리. PostgreSQL 최적화 쿼리 생성. 스키마 기반 코드 생성 |
| **NextAuth.js** | 5.x | Next.js 네이티브 인증 솔루션. Credential Provider로 이메일/비밀번호 인증. 세션 관리 내장. RBAC 구현 용이 |
| **xlsx** | latest | 엑셀 파일 파싱 및 생성. 다양한 엑셀 양식 지원. 서버 사이드 처리 가능 |

### 2.3 데이터베이스 및 스토리지

| 기술 | 선정 사유 |
|------|-----------|
| **PostgreSQL (Supabase)** | 관계형 데이터 모델에 최적. 트랜잭션 무결성 보장 (주문/정산). JSON 타입 지원 (유연한 메타데이터). Supabase 관리형으로 운영 부담 최소화 |
| **Supabase Storage** | PostgreSQL과 같은 플랫폼 내 파일 스토리지. RLS(Row Level Security) 기반 접근 제어. S3 호환 API로 AWS 전환 용이 |

### 2.4 실시간 통신

| 기술 | 선정 사유 |
|------|-----------|
| **WebSocket** | AI 채팅의 양방향 실시간 통신. 스트리밍 응답 지원 (Claude API 토큰 단위 전송). 알림 실시간 푸시. Socket.io 또는 ws 라이브러리 활용 |
| **Railway / Render** | WebSocket 서버 전용 호스팅. Vercel은 WebSocket 미지원이므로 별도 서버 필요. Docker 기반 배포로 AWS EC2 전환 용이 |

### 2.5 AI 및 외부 서비스

| 기술 | 선정 사유 |
|------|-----------|
| **Claude API (Anthropic)** | 한국어 자연어 이해 우수. Tool Use(Function Calling) 기반 기능 실행. 대용량 컨텍스트 윈도우로 엑셀 데이터 분석 적합. 스트리밍 응답 지원 |
| **CJ대한통운 API** | 국내 최대 택배사. API 연동 문서화 양호. 집하 요청, 송장 발급, 배송 추적 지원 |
| **카카오 알림톡 API** | B2B 거래처 대상 공식 알림 채널. 높은 도달률. 템플릿 기반 발송으로 일관된 안내 가능 |

### 2.6 배포 및 인프라

| 기술 | 선정 사유 |
|------|-----------|
| **Vercel** | Next.js 공식 배포 플랫폼. 무중단 배포, Edge 네트워크, 자동 스케일링. Preview Deployments로 PR별 테스트 환경 자동 구성 |
| **Docker** | WebSocket 서버 컨테이너화. 개발/운영 환경 일관성. AWS ECS/EC2 전환 시 동일 이미지 사용 |

---

## 3. 화면 목록 및 화면 흐름도

### 3.1 화면 목록

#### 공통 화면

| 화면 ID | 화면명 | 설명 | 접근 권한 |
|---------|--------|------|-----------|
| SCR-C-001 | 로그인 | 이메일/비밀번호 인증 로그인 | 전체 |
| SCR-C-002 | 회원가입 | 셀러 회원가입 (사업자등록증 첨부) | 비회원 |
| SCR-C-003 | 가입 대기 안내 | 관리자 승인 대기 중 안내 화면 | 미승인 셀러 |

#### 관리자 화면

| 화면 ID | 화면명 | 설명 |
|---------|--------|------|
| SCR-A-001 | 관리자 대시보드 | 주요 지표 요약 (오늘 주문, 매출, 미처리 건 등) |
| SCR-A-002 | 상품 목록 | 전체 상품 조회, 검색, 필터링 |
| SCR-A-003 | 상품 등록/수정 | 상품 정보 입력 및 수정 (이미지, 가격, 등급별 가격) |
| SCR-A-004 | 상품 엑셀 업로드 | 엑셀 파일 업로드로 대량 상품 등록 |
| SCR-A-005 | 가격 일괄 수정 | 상품 가격 개별/일괄 변경 |
| SCR-A-006 | 재고 관리 | 상품별 재고 현황 조회 및 수정 |
| SCR-A-007 | 주문 목록 | 전체 주문 조회, 상태별 필터링 |
| SCR-A-008 | 주문 상세 | 주문 상세 정보 조회, 상태 변경, 송장 입력 |
| SCR-A-009 | 주문 취합 | 공급사별/상품별 주문 취합 및 발주서 생성 |
| SCR-A-010 | 송장 관리 | 송장 엑셀 업로드, 자동 매칭, 개별 입력 |
| SCR-A-011 | 배송 관리 | 배송 현황 조회, 택배사 API 집하 요청, 배송 추적 |
| SCR-A-012 | 셀러 목록 | 전체 셀러 조회, 등급별 필터링 |
| SCR-A-013 | 셀러 상세 | 셀러 정보 수정, 등급/수수료 설정 |
| SCR-A-014 | 가입 승인 관리 | 가입 신청 목록, 사업자등록증 확인, 승인/반려 |
| SCR-A-015 | 등급 관리 | 셀러 등급 CRUD, 등급별 수수료율 설정 |
| SCR-A-016 | 정산 관리 | 셀러별 정산 현황, 수수료 내역, 클레임 반영 |
| SCR-A-017 | 매출 통계 | 일/주/월별 매출, 상품별/셀러별 통계 차트 |
| SCR-A-018 | 문의 관리 | 셀러 문의 목록 조회, 답변 작성 |
| SCR-A-019 | 클레임 관리 | 클레임 접수 목록, 승인/처리, 상태 관리 |
| SCR-A-020 | 공급사 목록 | 공급사 조회, 등록, 수정 |
| SCR-A-021 | 공급사 상세 | 공급사 정보, 발주 양식 관리, 발주/입고 이력 |
| SCR-A-022 | 공지사항 관리 | 공지 작성, 발송, 이력 조회 |
| SCR-A-023 | 시스템 설정 | 권한 관리, 활동 로그 조회 |

#### 셀러 화면

| 화면 ID | 화면명 | 설명 |
|---------|--------|------|
| SCR-S-001 | 셀러 대시보드 | 나의 주문 현황, 최근 알림 요약 |
| SCR-S-002 | 상품 목록 | 판매 가능 상품 조회 (등급별 가격 반영) |
| SCR-S-003 | 주문 업로드 | 엑셀 파일 업로드 또는 수동 주문 입력 |
| SCR-S-004 | 주문 현황 | 나의 주문 목록, 상태, 송장번호 확인 |
| SCR-S-005 | 주문 상세 | 개별 주문 상세 정보 및 배송 추적 |
| SCR-S-006 | 클레임 신청 | 반품/환불/교환 요청 등록 |
| SCR-S-007 | 클레임 현황 | 나의 클레임 진행 상태 조회 |
| SCR-S-008 | 나의 통계 | 매출, 판매량, 주문 추이 통계 |
| SCR-S-009 | 나의 정산 | 정산 내역, 수수료 내역 조회 |
| SCR-S-010 | 게시판 | 문의 작성 및 답변 확인 |
| SCR-S-011 | 알림 센터 | 알림 목록 조회 |

#### AI 채팅 (공통 컴포넌트)

| 화면 ID | 화면명 | 설명 |
|---------|--------|------|
| SCR-AI-001 | AI 채팅 패널 | 대시보드 우측 상시 표시 채팅창 (접기/펼치기) |
| SCR-AI-002 | 채팅 이력 | 과거 대화 내역 조회 |
| SCR-AI-003 | 파일 미리보기 | 업로드/다운로드 파일 미리보기 팝업 |

### 3.2 화면 흐름도

```
[비인증 사용자]
  로그인(SCR-C-001)
    ├─ 관리자 인증 → 관리자 대시보드(SCR-A-001)
    └─ 셀러 인증
        ├─ 승인됨 → 셀러 대시보드(SCR-S-001)
        └─ 미승인 → 가입 대기(SCR-C-003)
  회원가입(SCR-C-002) → 가입 대기(SCR-C-003)

[관리자 화면 흐름]
  관리자 대시보드(SCR-A-001)
    ├─ 상품관리 → 상품 목록(SCR-A-002)
    │   ├─ 상품 등록/수정(SCR-A-003)
    │   ├─ 엑셀 업로드(SCR-A-004)
    │   ├─ 가격 일괄 수정(SCR-A-005)
    │   └─ 재고 관리(SCR-A-006)
    ├─ 주문관리 → 주문 목록(SCR-A-007)
    │   ├─ 주문 상세(SCR-A-008)
    │   ├─ 주문 취합(SCR-A-009)
    │   └─ 송장 관리(SCR-A-010)
    ├─ 배송관리 → 배송 관리(SCR-A-011)
    ├─ 회원관리 → 셀러 목록(SCR-A-012)
    │   ├─ 셀러 상세(SCR-A-013)
    │   ├─ 가입 승인(SCR-A-014)
    │   └─ 등급 관리(SCR-A-015)
    ├─ 정산관리 → 정산 관리(SCR-A-016)
    │   └─ 매출 통계(SCR-A-017)
    ├─ CS관리
    │   ├─ 문의 관리(SCR-A-018)
    │   └─ 클레임 관리(SCR-A-019)
    ├─ 공급사관리 → 공급사 목록(SCR-A-020)
    │   └─ 공급사 상세(SCR-A-021)
    ├─ 공지관리 → 공지사항 관리(SCR-A-022)
    ├─ 시스템설정(SCR-A-023)
    └─ AI 채팅 패널(SCR-AI-001) ← 모든 화면에서 접근 가능

[셀러 화면 흐름]
  셀러 대시보드(SCR-S-001)
    ├─ 상품조회 → 상품 목록(SCR-S-002)
    ├─ 주문관리
    │   ├─ 주문 업로드(SCR-S-003)
    │   ├─ 주문 현황(SCR-S-004)
    │   └─ 주문 상세(SCR-S-005)
    ├─ 클레임
    │   ├─ 클레임 신청(SCR-S-006)
    │   └─ 클레임 현황(SCR-S-007)
    ├─ 나의 통계(SCR-S-008)
    ├─ 나의 정산(SCR-S-009)
    ├─ 게시판(SCR-S-010)
    ├─ 알림센터(SCR-S-011)
    └─ AI 채팅 패널(SCR-AI-001) ← 모든 화면에서 접근 가능
```

---

## 4. API 설계 개요

### 4.1 API 설계 원칙

- RESTful 설계 원칙 준수 (자원 기반 URL, HTTP 메서드 활용)
- Next.js App Router의 Route Handlers (`/api/*`) 활용
- 응답 형식: JSON (`{ success: boolean, data?: T, error?: string }`)
- 인증: NextAuth.js 세션 기반, API 미들웨어에서 역할 검증
- 페이지네이션: Cursor 기반 또는 Offset 기반 (목록 API)

### 4.2 주요 API 엔드포인트

#### 인증 (Auth)

| Method | Endpoint | 설명 | 권한 |
|--------|----------|------|------|
| POST | /api/auth/signup | 셀러 회원가입 | 공개 |
| POST | /api/auth/login | 로그인 | 공개 |
| POST | /api/auth/logout | 로그아웃 | 인증 |
| GET | /api/auth/session | 현재 세션 정보 | 인증 |

#### 상품 (Products)

| Method | Endpoint | 설명 | 권한 |
|--------|----------|------|------|
| GET | /api/products | 상품 목록 조회 (필터/검색/페이지네이션) | 인증 |
| GET | /api/products/:id | 상품 상세 조회 | 인증 |
| POST | /api/products | 상품 등록 | 관리자 |
| PUT | /api/products/:id | 상품 수정 | 관리자 |
| DELETE | /api/products/:id | 상품 삭제 | 관리자 |
| POST | /api/products/bulk-upload | 상품 엑셀 대량 등록 | 관리자 |
| PUT | /api/products/bulk-price | 상품 가격 일괄 수정 | 관리자 |
| GET | /api/products/export | 상품 목록 엑셀 다운로드 | 인증 |
| GET | /api/products/:id/prices | 상품 등급별/셀러별 가격 조회 | 관리자 |
| PUT | /api/products/:id/prices | 상품 등급별/셀러별 가격 설정 | 관리자 |
| GET | /api/products/:id/stock | 재고 조회 | 인증 |
| PUT | /api/products/:id/stock | 재고 수정 | 관리자 |

#### 주문 (Orders)

| Method | Endpoint | 설명 | 권한 |
|--------|----------|------|------|
| GET | /api/orders | 주문 목록 조회 | 인증 (셀러: 본인만) |
| GET | /api/orders/:id | 주문 상세 조회 | 인증 (셀러: 본인만) |
| POST | /api/orders | 주문 생성 (수동 입력) | 인증 |
| POST | /api/orders/upload | 주문 엑셀 업로드 | 인증 |
| PUT | /api/orders/:id/status | 주문 상태 변경 | 관리자 |
| GET | /api/orders/aggregate | 공급사별/상품별 주문 취합 조회 | 관리자 |
| GET | /api/orders/export/purchase | 공급사별 발주서 엑셀 다운로드 | 관리자 |

#### 배송/송장 (Shipping)

| Method | Endpoint | 설명 | 권한 |
|--------|----------|------|------|
| POST | /api/shipping/invoice/upload | 송장 엑셀 업로드 (자동 매칭) | 관리자 |
| PUT | /api/shipping/invoice/:orderId | 개별 송장번호 입력 | 관리자 |
| POST | /api/shipping/pickup-request | 택배사 집하 요청 | 관리자 |
| GET | /api/shipping/tracking/:trackingNo | 배송 추적 | 인증 |

#### 회원 (Members)

| Method | Endpoint | 설명 | 권한 |
|--------|----------|------|------|
| GET | /api/members | 셀러 목록 조회 | 관리자 |
| GET | /api/members/:id | 셀러 상세 조회 | 관리자 |
| PUT | /api/members/:id | 셀러 정보 수정 | 관리자 |
| PUT | /api/members/:id/approve | 셀러 가입 승인/반려 | 관리자 |
| GET | /api/members/pending | 가입 대기 목록 | 관리자 |
| GET | /api/grades | 등급 목록 조회 | 관리자 |
| POST | /api/grades | 등급 생성 | 관리자 |
| PUT | /api/grades/:id | 등급 수정 (수수료율 포함) | 관리자 |
| DELETE | /api/grades/:id | 등급 삭제 | 관리자 |

#### 정산 (Settlement)

| Method | Endpoint | 설명 | 권한 |
|--------|----------|------|------|
| GET | /api/settlements | 정산 목록 조회 | 인증 (셀러: 본인만) |
| GET | /api/settlements/:sellerId | 셀러별 정산 상세 | 관리자 |
| POST | /api/settlements/calculate | 정산 계산 실행 (배치) | 관리자 |
| GET | /api/settlements/export | 정산 내역 엑셀 다운로드 | 관리자 |

#### 통계 (Statistics)

| Method | Endpoint | 설명 | 권한 |
|--------|----------|------|------|
| GET | /api/stats/dashboard | 대시보드 요약 통계 | 인증 |
| GET | /api/stats/sales | 매출 통계 (일/주/월) | 인증 (셀러: 본인만) |
| GET | /api/stats/products | 상품별 판매량/매출 통계 | 인증 (셀러: 본인만) |
| GET | /api/stats/sellers | 셀러별 통계 | 관리자 |
| GET | /api/stats/orders | 주문 상태별 현황 | 인증 (셀러: 본인만) |
| GET | /api/stats/top-products | 판매량/매출 Top N | 관리자 |

#### CS (Customer Service)

| Method | Endpoint | 설명 | 권한 |
|--------|----------|------|------|
| GET | /api/inquiries | 문의 목록 조회 | 인증 (셀러: 본인만) |
| POST | /api/inquiries | 문의 작성 | 셀러 |
| PUT | /api/inquiries/:id/reply | 문의 답변 | 관리자 |
| GET | /api/claims | 클레임 목록 조회 | 인증 (셀러: 본인만) |
| POST | /api/claims | 클레임 등록 | 셀러 |
| PUT | /api/claims/:id | 클레임 처리 (승인/반려/완료) | 관리자 |

#### 공급사 (Suppliers)

| Method | Endpoint | 설명 | 권한 |
|--------|----------|------|------|
| GET | /api/suppliers | 공급사 목록 조회 | 관리자 |
| GET | /api/suppliers/:id | 공급사 상세 조회 | 관리자 |
| POST | /api/suppliers | 공급사 등록 | 관리자 |
| PUT | /api/suppliers/:id | 공급사 수정 | 관리자 |
| POST | /api/suppliers/:id/template | 발주서 양식 템플릿 등록 | 관리자 |
| GET | /api/suppliers/:id/history | 발주/입고 이력 조회 | 관리자 |

#### 알림/공지 (Notifications)

| Method | Endpoint | 설명 | 권한 |
|--------|----------|------|------|
| GET | /api/notifications | 알림 목록 조회 | 인증 |
| PUT | /api/notifications/:id/read | 알림 읽음 처리 | 인증 |
| GET | /api/notices | 공지사항 목록 조회 | 인증 |
| POST | /api/notices | 공지사항 작성 | 관리자 |

#### AI 채팅 (Chat)

| Method | Endpoint | 설명 | 권한 |
|--------|----------|------|------|
| WebSocket | /ws/chat | AI 채팅 WebSocket 연결 | 인증 |
| POST | /api/chat/upload | 채팅 내 파일 업로드 | 인증 |
| GET | /api/chat/history | 채팅 이력 조회 | 인증 |
| GET | /api/chat/download/:fileId | 채팅 생성 파일 다운로드 | 인증 |

---

## 5. 데이터 모델 개요

### 5.1 핵심 엔티티 관계도 (ERD)

```
+------------------+       +------------------+       +------------------+
|      User        |       |      Grade       |       |    Supplier      |
+------------------+       +------------------+       +------------------+
| id          PK   |   +-->| id          PK   |       | id          PK   |
| email        UQ  |   |   | name             |       | name             |
| password         |   |   | commissionRate   |       | contactName      |
| name             |   |   | description      |       | phone            |
| phone            |   |   | sortOrder        |       | email            |
| role (ADMIN/     |   |   | createdAt        |       | address          |
|  SELLER)         |   |   | updatedAt        |       | templateUrl      |
| status (PENDING/ |   |   +------------------+       | memo             |
|  APPROVED/       |   |                              | createdAt        |
|  REJECTED)       |   |                              | updatedAt        |
| gradeId     FK --+---+                              +--------+---------+
| businessRegNo    |                                           |
| businessRegFile  |                                           |
| customCommission |   +------------------+                    |
| createdAt        |   |    Product       |                    |
| updatedAt        |   +------------------+                    |
+--------+---------+   | id          PK   |                    |
         |             | name             |                    |
         |             | description      |                    |
         |             | basePrice        |                    |
         |             | categoryId  FK   |                    |
         |             | supplierId  FK --+--------------------+
         |             | status (ACTIVE/  |
         |             |  SOLD_OUT/       |
         |             |  DISCONTINUED)   |
         |             | stockQty         |
         |             | safeStockQty     |
         |             | unit             |
         |             | imageUrl         |
         |             | createdAt        |
         |             | updatedAt        |
         |             +--------+---------+
         |                      |
         |    +-----------------+------------------+
         |    |                                    |
         |    v                                    v
         |  +------------------+    +------------------+
         |  | ProductGradePrice|    | ProductSellerPrice|
         |  +------------------+    +------------------+
         |  | id          PK   |    | id          PK    |
         |  | productId   FK   |    | productId   FK    |
         |  | gradeId     FK   |    | sellerId    FK    |
         |  | price            |    | price             |
         |  | createdAt        |    | createdAt         |
         |  | updatedAt        |    | updatedAt         |
         |  +------------------+    +------------------+
         |
         v
+------------------+       +------------------+
|      Order       |       |    OrderItem     |
+------------------+       +------------------+
| id          PK   |   +-->| id          PK   |
| orderNo     UQ   |   |   | orderId     FK --+--+
| sellerId    FK --+---+   | productId   FK   |  |
| status (PENDING/ |   |   | quantity         |  |
|  CONFIRMED/      |   |   | unitPrice        |  |
|  SHIPPING/       |   |   | totalPrice       |  |
|  DELIVERED/      |   |   | supplierId  FK   |  |
|  CANCELLED)      |   |   | trackingNo       |  |
| totalAmount      |   |   | trackingCompany  |  |
| recipientName    |   |   | deliveryStatus   |  |
| recipientPhone   |   |   | createdAt        |  |
| recipientAddress |   |   | updatedAt        |  |
| memo             |   |   +------------------+  |
| sourceChannel    |   |                          |
| sourceOrderNo    |   |                          |
| createdAt        |   |                          |
| updatedAt        |   |                          |
+------------------+   |                          |
                        |                          |
+------------------+    |   +------------------+   |
|     Claim        |    |   |   Settlement     |   |
+------------------+    |   +------------------+   |
| id          PK   |    |   | id          PK   |   |
| orderId     FK --+----+   | sellerId    FK   |   |
| orderItemId FK   |        | periodStart      |   |
| sellerId    FK   |        | periodEnd        |   |
| type (RETURN/    |        | totalSales       |   |
|  REFUND/         |        | commissionRate   |   |
|  EXCHANGE)       |        | commissionAmount |   |
| reason           |        | claimDeduction   |   |
| status (PENDING/ |        | netAmount        |   |
|  APPROVED/       |        | status (PENDING/ |   |
|  REJECTED/       |        |  CONFIRMED/      |   |
|  COMPLETED)      |        |  PAID)           |   |
| amount           |        | createdAt        |   |
| adminMemo        |        | updatedAt        |   |
| newTrackingNo    |        +------------------+   |
| createdAt        |                               |
| updatedAt        |                               |
+------------------+                               |
                                                   |
+------------------+    +------------------+       |
|    Invoice       |    | PurchaseOrder    |       |
+------------------+    +------------------+       |
| id          PK   |    | id          PK   |       |
| supplierId  FK   |    | supplierId  FK   |       |
| uploadedFileUrl  |    | orderItems  FK[] +-------+
| matchedCount     |    | fileUrl          |
| unmatchedCount   |    | status (CREATED/ |
| status           |    |  SENT/RECEIVED)  |
| createdAt        |    | createdAt        |
| updatedAt        |    | updatedAt        |
+------------------+    +------------------+

+------------------+    +------------------+
|   Notification   |    |     Notice       |
+------------------+    +------------------+
| id          PK   |    | id          PK   |
| userId      FK   |    | title            |
| type             |    | content          |
| title            |    | authorId    FK   |
| content          |    | isPublished      |
| isRead           |    | targetGrades     |
| relatedId        |    | createdAt        |
| relatedType      |    | updatedAt        |
| createdAt        |    +------------------+
+------------------+

+------------------+    +------------------+
|   ChatSession    |    |   ChatMessage    |
+------------------+    +------------------+
| id          PK   |    | id          PK   |
| userId      FK   |    | sessionId   FK   |
| title            |    | role (USER/AI)   |
| createdAt        |    | content          |
| updatedAt        |    | fileUrl          |
+------------------+    | toolCalls        |
                        | createdAt        |
                        +------------------+

+------------------+    +------------------+
|    Category      |    |   ActivityLog    |
+------------------+    +------------------+
| id          PK   |    | id          PK   |
| name             |    | userId      FK   |
| parentId    FK   |    | action           |
| sortOrder        |    | targetType       |
| createdAt        |    | targetId         |
| updatedAt        |    | details (JSON)   |
+------------------+    | ipAddress        |
                        | createdAt        |
                        +------------------+
```

### 5.2 핵심 엔티티 설명

| 엔티티 | 설명 | 주요 관계 |
|--------|------|-----------|
| **User** | 관리자/셀러 사용자. role로 역할 구분, status로 가입 상태 관리 | Grade(N:1), Order(1:N), Claim(1:N) |
| **Grade** | 셀러 등급 (골드/실버/브론즈 등). 등급별 수수료율 및 가격 차등 | User(1:N), ProductGradePrice(1:N) |
| **Product** | 판매 상품. 기본가격 외 등급별/셀러별 특가 설정 가능 | Supplier(N:1), Category(N:1), OrderItem(1:N) |
| **ProductGradePrice** | 상품별 등급별 차등 가격 | Product(N:1), Grade(N:1) |
| **ProductSellerPrice** | 상품별 특정 셀러 개별 가격 (등급 무관) | Product(N:1), User(N:1) |
| **Order** | 셀러 주문 헤더. 주문번호, 수취인 정보, 소스 채널 등 | User(N:1), OrderItem(1:N) |
| **OrderItem** | 주문 내 개별 상품 항목. 송장 정보 포함 | Order(N:1), Product(N:1), Supplier(N:1) |
| **Supplier** | 공급사 정보. 발주서 양식 템플릿 보유 | Product(1:N), PurchaseOrder(1:N) |
| **Claim** | 반품/환불/교환 클레임. 정산에 자동 반영 | Order(N:1), OrderItem(N:1), User(N:1) |
| **Settlement** | 기간별 셀러 정산 내역. 매출-수수료-클레임 반영 | User(N:1) |
| **PurchaseOrder** | 공급사 발주서. 주문 취합 후 생성되는 공급사별 발주 | Supplier(N:1), OrderItem(N:M) |
| **Invoice** | 공급사 송장 엑셀 업로드 기록. 매칭 결과 추적 | Supplier(N:1) |
| **Notification** | 인앱 알림 (송장 입력, 가격 변동, 재고 부족 등) | User(N:1) |
| **Notice** | 관리자 공지사항. 전체/등급별 발송 | User(N:1, author) |
| **ChatSession** | AI 채팅 세션. 사용자별 대화 이력 관리 | User(N:1), ChatMessage(1:N) |
| **ChatMessage** | 채팅 메시지 (사용자/AI). 파일 첨부 및 Tool Call 기록 | ChatSession(N:1) |
| **Category** | 상품 카테고리 (계층형). 농산물/수산물/축산물 등 | Product(1:N), 자기참조(parentId) |
| **ActivityLog** | 관리자 활동 로그. 주요 조작 이력 기록 | User(N:1) |

### 5.3 주요 데이터 관계 정리

1. **가격 체계**: Product(기본가) → ProductGradePrice(등급가) → ProductSellerPrice(특가). 우선순위: 특가 > 등급가 > 기본가
2. **주문-배송 흐름**: Order → OrderItem → (Supplier별 취합) → PurchaseOrder → Invoice(송장 매칭) → 배송 추적
3. **정산 흐름**: OrderItem(매출) - Claim(차감) → Settlement(수수료 적용 후 정산)
4. **AI 채팅 흐름**: ChatSession → ChatMessage(toolCalls 포함) → 실제 API 호출 → 결과 메시지 반환

---

> **문서 끝** — 본 문서는 Part 1 (현황 분석 및 요구사항 정의)과 Part 2 (기술 아키텍처 설계)를 포함한 네놈마켓 B2B 플랫폼의 종합 분석 및 설계서입니다.
